---
layout: jvm3
title: jvm源码之垃圾回收,内存分配策略
date: 2020-04-03 00:20:38
tags: 源码分析
comments: true
---

### 垃圾回收

#### 如何判定对象为垃圾对象

  ###### 引用计数法(目前虚拟机几乎没有使用该算法)

在对象中添加引用计数器，当有地方引用这个对象的时候,引用计数器得值就+1，当引用失效(值为null,0)的时候引用计数器得值就-1。

<!--more-->

打印垃圾回收器的日志信息方法:

在run configuration VM 添加参数

-verbose:gc     //这是偏简单的日志信息

-xx:PrintGCDetail

一起加在里面：

-verbose:gc -XX:+PrintGCDetails

  ###### 可达性分析法

作为GCRoots的对象,不可达的对象就会被回收

​    虚拟机栈的对象

   方法区的类属性所引用的对象

   方法区中常量所引用对象

   本地方法栈中的引用对象



#### 如何回收

   ##### 回收策略

​        标记-清除算法

​        复制算法

​        标记-整理算法

​        分代收集算法

    ##### 垃圾回收器

​        Serial

​        Parnew

​        Cms



### 内存分配策略

优先分配到Eden

大对象直接进入到老年代

长期存活的对象分配到老年代

如果Eden区域内存不够,可以到老年代去借(空间担保）